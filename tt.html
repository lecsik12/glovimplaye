<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>GlovimPlaye</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
  
  <!-- Фавикон -->
  <link rel="icon" type="image/png" href="images/logo (2).png" sizes="16x16">
  
  <!-- Font Awesome для иконок -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" />
  
  <!-- Firebase v8 -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
  
  <style>
    /* Сброс и базовые стили */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Montserrat', sans-serif;
      background: #0e0e0e;
      color: #ccc;
      min-height: 100vh;
      line-height: 1.6;
      padding-bottom: 70px; /* нижняя панель для мобильных */
      padding-right: 270px; /* отступ для правой панели на десктопе */
      transition: background 0.3s, color 0.3s;
    }
    a {
      text-decoration: none;
      color: inherit;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }
    
    /* Хедер */
    header {
      background: linear-gradient(135deg, #000, #393838);
      padding: 10px 20px;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }
    .header-wrapper {
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
    }
    /* Левый блок: Логотип */
    .header-left .logo {
      display: flex;
      align-items: center;
      color: #d3be05;
      font-size: 1.5em;
      font-weight: bold;
    }
    .header-left .logo img {
      width: 60px;
      margin-right: 10px;
    }
    /* Центр: меню и поиск */
    .header-center {
      display: flex;
      align-items: center;
      flex-grow: 1;
      justify-content: center;
      gap: 30px;
      margin: 10px 0;
    }
    .nav-links a {
      color: #f0ebeb;
      margin: 0 10px;
      transition: color 0.3s;
    }
    .nav-links a:hover {
      color: #fffb00;
    }
    .search-box {
      position: relative;
    }
    .search-box input.search-input {
      padding: 5px 30px 5px 10px;
      border: none;
      border-radius: 20px;
      outline: none;
      width: 150px;
      transition: width 0.3s;
    }
    .search-box input.search-input:focus {
      width: 200px;
    }
    .search-box button.search-btn {
      position: absolute;
      right: 5px;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: #333;
      cursor: pointer;
    }
    /* Правый блок: тема, чат, уведомления, профиль */
    .header-right {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    .theme-btn {
      background: none;
      border: none;
      color: #8e8e8c;
      font-size: 1.2em;
      cursor: pointer;
      transition: transform 0.3s;
      display: flex;
      align-items: center;
    }
    .theme-btn:hover {
      transform: scale(1.1);
    }
    .chat-icon, .notifications-icon {
      color: #8e8e8c;
      font-size: 1.2em;
      transition: color 0.3s, transform 0.3s;
    }
    .chat-icon:hover, .notifications-icon:hover {
      transform: scale(1.1);
    }
    .profile img {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      border: 2px solid #8e8e8c;
    }
    
    /* Hero секция */
    .hero-section {
      background: #161616;
      background-image: url('images/gl.png');
      background-size: cover;
      background-position: center;
      color: #fff;
      padding: 60px 20px;
      text-align: center;
      border-radius: 8px;
      margin: 40px 20px;
      position: relative;
    }
    .hero-section h1 {
      font-size: 36px;
      margin-bottom: 20px;
      color: #f1f1ec;
    }
    .hero-section p {
      font-size: 18px;
      max-width: 700px;
      margin: 0 auto 30px;
    }
    .hero-btn {
      background: #4fc3f7;
      color: #121212;
      padding: 12px 24px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      transition: background 0.3s;
    }
    .hero-btn:hover {
      background: #80deea;
    }
    
    /* Карточки игр и приложений */
    .cards-row {
      display: grid;
      gap: 20px;
      margin: 20px;
    }
    .small-row {
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    }
    .card {
      position: relative;
      background-size: cover;
      background-position: center;
      border-radius: 10px;
      overflow: hidden;
      height: 180px;
      cursor: pointer;
      transition: transform 0.3s, box-shadow 0.3s;
    }
    .card:hover {
      transform: scale(1.05);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
    }
    .card-content {
      position: absolute;
      bottom: 0;
      width: 100%;
      padding: 10px;
      background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
    }
    .card-content h3 {
      font-size: 18px;
      color: #fff;
    }
    
    /* Горизонтальный скролл для категорий */
    .horizontal-scroll {
      display: flex;
      overflow-x: auto;
      padding: 10px 20px;
      gap: 16px;
      margin-bottom: 20px;
    }
    .horizontal-scroll::-webkit-scrollbar {
      height: 6px;
    }
    .horizontal-scroll::-webkit-scrollbar-thumb {
      background: #333;
      border-radius: 4px;
    }
    .horizontal-scroll::-webkit-scrollbar-track {
      background: #1e1e1e;
    }
    .game-card {
      width: 80px;
      text-align: center;
      cursor: pointer;
      flex-shrink: 0;
    }
    .game-card img {
      width: 80px;
      height: 80px;
      object-fit: cover;
      border-radius: 8px;
      transition: transform 0.2s;
    }
    .game-card img:hover {
      transform: scale(1.05);
    }
    .game-name {
      margin-top: 6px;
      font-size: 13px;
      white-space: nowrap;
    }
    .new-badge {
      background: #ff4500;
      color: #fff;
      font-size: 10px;
      padding: 2px 5px;
      border-radius: 4px;
      margin-left: 5px;
    }
    
    /* Блок "О сайте" */
    .about-section {
      background: #161616;
      padding: 30px 20px;
      margin: 20px;
      border-radius: 8px;
    }
    .about-section h2 {
      color: #4fc3f7;
      margin-bottom: 15px;
    }
    .about-section p {
      line-height: 1.6;
    }
    
    /* Контент страницы */
    .page-wrapper {
      max-width: 1200px;
      margin: 20px auto;
      padding: 20px;
    }
    
    /* Админ-панель (справа) */
    .admin-sidebar {
      position: fixed;
      top: 0;
      right: 0;
      width: 250px;
      height: 100vh;
      background: #1e1e1e;
      border-left: 1px solid #333;
      padding: 20px;
      overflow-y: auto;
      transition: transform 0.3s ease, background 0.3s;
      z-index: 100;
    }
    .sidebar-logo {
      font-size: 24px;
      font-weight: 600;
      color: #4fc3f7;
      text-align: center;
      margin-bottom: 20px;
      cursor: pointer;
      text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
    }
    .admin-sidebar h3 {
      font-size: 18px;
      color: #fff;
      margin: 20px 0 10px;
    }
    .admin-account {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      margin-bottom: 15px;
      background: #262626;
      padding: 10px;
      border-radius: 8px;
      transition: background 0.3s;
      cursor: pointer;
    }
    .admin-account:hover {
      background: #333;
    }
    .admin-account img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin-bottom: 5px;
      object-fit: cover;
    }
    .admin-name {
      font-size: 14px;
      color: #ccc;
    }
    .admin-role {
      font-size: 12px;
      color: #aaa;
      margin-top: 3px;
    }
    .menu-list {
      list-style: none;
      padding: 0;
      margin-top: 20px;
    }
    .menu-item {
      transition: background 0.3s;
      margin-bottom: 8px;
    }
    .menu-item a {
      display: flex;
      align-items: center;
      padding: 8px 15px;
      color: #ccc;
      text-decoration: none;
    }
    .menu-item i {
      font-size: 18px;
      margin-right: 10px;
      color: #888;
    }
    .menu-item a:hover {
      background-color: #2b2b2b;
      color: #fff;
    }
    .menu-item.active a {
      border-left: 4px solid #4fc3f7;
      background-color: #2b2b2b;
      color: #fff;
    }
    
    .button {
      display: inline-block;
      padding: 10px 20px;
      background-color: #4fc3f7;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      transition: background-color 0.3s, box-shadow 0.3s;
      margin-top: 10px;
    }
    .button:hover {
      background-color: #39a0d8;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    }
    
    /* Футер */
    footer {
      background: #161616;
      color: #777;
      padding: 30px 20px;
      margin-top: 20px;
      transition: background 0.3s, color 0.3s;
    }
    footer .container {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-around;
      gap: 20px;
    }
    footer h3, footer h4 {
      color: #4fc3f7;
      margin-bottom: 8px;
    }
    footer a {
      color: #777;
      font-size: 14px;
    }
    footer a:hover {
      color: #fff;
    }
    footer p {
      font-size: 13px;
    }
    .footer-btn {
      background: #4fc3f7;
      color: #121212;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .footer-btn:hover {
      background: #80deea;
    }
    footer p.copyright {
      text-align: center;
      margin-top: 20px;
      font-size: 13px;
    }
    
    /* Нижняя панель (мобильная навигация) */
    .bottom-nav {
      display: none;
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 60px;
      background: #161616;
      border-top: 1px solid #333;
      align-items: center;
      justify-content: space-around;
      z-index: 110;
    }
    .bottom-nav a {
      color: #ccc;
      font-size: 12px;
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .bottom-nav a i {
      font-size: 22px;
      margin-bottom: 3px;
    }
    .bottom-nav a:hover {
      color: #4fc3f7;
    }
    .bottom-nav-profile img.avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      border: 2px solid #4fc3f7;
      object-fit: cover;
      margin-bottom: 2px;
    }
    
    /* Результаты поиска */
    .search-results {
      position: absolute;
      top: 60px;
      left: 50%;
      transform: translateX(-50%);
      background: #1e1e1e;
      width: 100%;
      max-width: 400px;
      max-height: 300px;
      overflow-y: auto;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.8);
      display: none;
      z-index: 10;
    }
    .search-result-item {
      display: flex;
      align-items: center;
      padding: 10px 15px;
      border-bottom: 1px solid #333;
      cursor: pointer;
      transition: background 0.3s;
    }
    .search-result-item:hover {
      background: #262626;
    }
    .search-result-item img {
      width: 40px;
      height: 40px;
      object-fit: cover;
      border-radius: 4px;
      margin-right: 15px;
    }
    .result-text {
      display: flex;
      flex-direction: column;
    }
    .result-name {
      font-weight: 600;
      color: #fff;
    }
    .no-results {
      padding: 10px 15px;
      color: #888;
    }
    
    /* Светлая тема */
    body.light-mode {
      background: #fff;
      color: #333;
      padding-right: 270px;
    }
    body.light-mode header {
      background: #f8f8f8;
      border-bottom: 1px solid #ddd;
    }
    body.light-mode .nav-links a {
      color: #333;
    }
    body.light-mode .nav-links a:hover {
      color: #007bff;
    }
    body.light-mode .search-box input.search-input {
      background: #fff;
      color: #333;
      border: 1px solid #ccc;
    }
    body.light-mode .search-box input.search-input::placeholder {
      color: #999;
    }
    
    /* Мобильные стили */
    @media (max-width: 768px) {
      body {
        padding-right: 0;
        padding-bottom: 80px;
      }
      .admin-sidebar {
        display: none;
      }
      .header-center {
        gap: 10px;
        flex-basis: 100%;
        justify-content: space-between;
      }
      .nav-links {
        display: none;
      }
      /* Скрываем чат, уведомления и профиль в хедере на телефоне */
      .header-right .chat-icon,
      .header-right .notifications-icon,
      .header-right .profile {
        display: none;
      }
      .bottom-nav {
        display: flex;
      }
    }
  </style>
</head>
<body>
  <!-- Хедер -->
  <header>
    <div class="header-wrapper container">
      <!-- Левый блок: логотип -->
      <div class="header-left">
        <a href="index.html" class="logo">
          <img src="images/logo (2).png" alt="Logo">
          <span>GlovimPlaye</span>
        </a>
      </div>
      <!-- Центр: меню и поиск -->
      <div class="header-center">
        <nav class="nav-links">
          <a href="index.html">Донат</a>
          <a href="about.html">Акаунты</a>
          <a href="services.html">Услуги</a>
        </nav>
        <div class="search-box">
          <input type="text" placeholder="Поиск..." class="search-input">
          <button class="search-btn"><i class="fas fa-search"></i></button>
        </div>
      </div>
      <!-- Правый блок: тема, чат, уведомления, профиль -->
      <div class="header-right">
        <button class="theme-btn" id="themeToggle" title="Сменить тему">
          <i class="fas fa-sun"></i><span></span>
        </button>
        <a href="chat.html" class="chat-icon" title="Чат">
          <i class="fas fa-comments"></i>
        </a>
        <a href="notifications.html" class="notifications-icon" title="Уведомления">
          <i class="fas fa-bell"></i>
        </a>
        <a href="profile.html" class="profile">
          <img id="headerProfileAvatar" src="default-avatar.png" alt="Profile">
        </a>
      </div>
    </div>
  </header>
  
  <!-- Результаты поиска -->
  <div class="search-results" id="search-results"></div>
  
  <!-- Hero секция -->
  <section class="hero-section">
    <div class="container">
      <h1>Биржа для торговли между игроками</h1>
      <p>GlovimPlaye – безопасный маркетплейс для продажи и покупки внутриигровых ценностей, предметов, валюты и аккаунтов.</p>
      <button class="hero-btn">Купить акаунт</button>
    </div>
  </section>
  
  <!-- Заголовок событий -->
  <div class="container">
    <h1>События в играх</h1>
  </div>
  
  <!-- Ряд карточек событий -->
  <div class="cards-row small-row">
    <div class="card" style="background-image: url('images/wor.jpg');">
      <div class="card-content">
        <h3>World of Tanks Blitz</h3>
      </div>
    </div>
    <div class="card" style="background-image: url('images/wor2.jpg');">
      <div class="card-content">
        <h3>World of Tanks</h3>
      </div>
    </div>
    <div class="card" style="background-image: url('images/gi.jpg');">
      <div class="card-content">
        <h3>Genshin Impact</h3>
      </div>
    </div>
    <div class="card" style="background-image: url('images/mbl.jpg');">
      <div class="card-content">
        <h3>Mobile Legends</h3>
      </div>
    </div>
    <div class="card" style="background-image: url('images/bl.jpg');">
      <div class="card-content">
        <h3>Больше игр в каталоге</h3>
      </div>
    </div>
  </div>
  
  <!-- Основной контент: Игры, Мобильные игры, Приложения -->
  <div class="container">
    <h2 class="section-title">Игры</h2>
    <div class="horizontal-scroll">
      <div class="game-card" onclick="location.href='csgo.html'">
        <img src="images/csgo.jpg" alt="Counter-Strike">
        <div class="game-name">Counter-Strike</div>
      </div>
      <!-- Добавляйте остальные карточки по необходимости -->
    </div>
    
    <h2 class="section-title">Мобильные игры</h2>
    <div class="horizontal-scroll">
      <!-- Карточки мобильных игр -->
    </div>
    
    <h2 class="section-title">Приложения</h2>
    <div class="horizontal-scroll">
      <!-- Карточки приложений -->
    </div>
  </div>
  
  <!-- Нижняя панель (мобильная навигация) -->
  <div class="bottom-nav">
    <a href="index.html">
      <i class="fas fa-home"></i>
      <span>Главная</span>
    </a>
    <a href="add.html">
      <i class="fas fa-plus"></i>
      <span>Продать</span>
    </a>
    <a href="chat.html">
      <i class="fas fa-comment-dots"></i>
      <span>Чат</span>
    </a>
    <a href="profile.html" class="bottom-nav-profile">
      <img src="default-avatar.png" alt="Avatar" class="avatar">
      <span>Профиль</span>
    </a>
  </div>
  
  <!-- Админ-панель (справа) -->
  <aside class="admin-sidebar" id="adminSidebar">
    <div class="sidebar-logo" onclick="location.href='index.html'">GlovimGame</div>
    <ul class="menu-list">
      <li class="menu-item">
        <a href="accounts.html">
          <i class="fas fa-user"></i>
          <span>Мои аккаунты</span>
        </a>
      </li>
      <li class="menu-item">
        <a href="purchases.html">
          <i class="fas fa-shopping-cart"></i>
          <span>Мои покупки</span>
        </a>
      </li>
      <li class="menu-item">
        <a href="operations.html">
          <i class="fas fa-exchange-alt"></i>
          <span>Мои операции</span>
        </a>
      </li>
      <li class="menu-item">
        <a href="transferred.html">
          <i class="fas fa-share-square"></i>
          <span>Переданные аккаунты</span>
        </a>
      </li>
      <li class="menu-item">
        <a href="reviews.html">
          <i class="fas fa-star"></i>
          <span>Мои отзывы</span>
        </a>
      </li>
      <li class="menu-item">
        <a href="favorites.html">
          <i class="fas fa-heart"></i>
          <span>Избранное</span>
        </a>
      </li>
      <li class="menu-item">
        <a href="labels.html">
          <i class="fas fa-tags"></i>
          <span>Управление метками</span>
        </a>
      </li>
      <li class="menu-item">
        <a href="ignore-sellers.html">
          <i class="fas fa-user-slash"></i>
          <span>Игнор-лист продавцов</span>
        </a>
      </li>
      <li class="menu-item">
        <a href="block-buyers.html">
          <i class="fas fa-ban"></i>
          <span>Блок-лист покупателей</span>
        </a>
      </li>
      <li class="menu-item">
        <a href="disputes.html">
          <i class="fas fa-handshake"></i>
          <span>Мои денежные споры</span>
        </a>
      </li>
      <li class="menu-item">
        <a href="auto-buy.html">
          <i class="fas fa-shopping-bag"></i>
          <span>Автоматические покупки</span>
        </a>
      </li>
      <li class="menu-item">
        <a href="auto-payment.html">
          <i class="fas fa-credit-card"></i>
          <span>Автоплатежи</span>
        </a>
        <button class="button">Нажми меня</button>
      </li>
    </ul>
    <h3>Админы</h3>
    <!-- Динамическая загрузка админов -->
  </aside>
  
  <!-- Футер -->
  <footer>
    <div class="container">
      <div>
        <h3>О сайте</h3>
        <p>Описание сайта GlovimPlaye – маркетплейса для торговли внутриигровыми ценностями.</p>
      </div>
      <div>
        <h4>Навигация</h4>
        <a href="index.html">Главная</a><br>
        <a href="about.html">Акаунты</a><br>
        <a href="services.html">Услуги</a>
      </div>
      <div>
        <h4>Контакты</h4>
        <a href="mailto:info@glovimplaye.ru">info@glovimplaye.ru</a>
      </div>
    </div>
    <p class="copyright">&copy; 2025 GlovimPlaye. Все права защищены.</p>
  </footer>
  
  <script>
    // Firebase-конфигурация и инициализация
    var firebaseConfig = {
      apiKey: "AIzaSyAhn2H2BExFFf7GO2k_YDfrwPiV_cYdUBg",
      authDomain: "glovimplaye-b1023.firebaseapp.com",
      databaseURL: "https://glovimplaye-b1023-default-rtdb.firebaseio.com",
      projectId: "glovimplaye-b1023",
      storageBucket: "glovimplaye-b1023.firebasestorage.app",
      messagingSenderId: "553440591519",
      appId: "1:553440591519:web:b7be45a9253689f322acaa"
    };
    if (!firebase.apps.length) {
      firebase.initializeApp(firebaseConfig);
    }
    
    firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL)
      .then(function() {
        console.log("Сессия установлена");
        loadAdmins();
      })
      .catch(function(error) {
        console.error("Ошибка установки сессии:", error);
      });
    
    function loadHeaderData(user) {
      var userId = user.uid;
      firebase.database().ref('users/' + userId).once('value')
        .then(function(snapshot) {
          var userData = snapshot.val();
          if (userData) {
            var headerBalance = document.querySelector('#headerBalance span');
            if(headerBalance) {
              headerBalance.innerText = (userData.balance !== undefined ? userData.balance : 0) + '₽';
            }
            var avatarUrl = userData.avatar || user.photoURL || 'default-avatar.png';
            document.getElementById('headerProfileAvatar').src = avatarUrl;
          } else {
            console.log("Данные пользователя не найдены");
          }
        })
        .catch(function(error) {
          console.error("Ошибка чтения данных пользователя:", error);
        });
    }
    
    function updateBottomNavAvatar(user) {
      var avatarUrl = user.photoURL || 'default-avatar.png';
      firebase.database().ref('users/' + user.uid).once('value')
        .then(function(snapshot) {
          var userData = snapshot.val();
          if (userData && userData.avatar) {
            avatarUrl = userData.avatar;
          }
          document.querySelector('.bottom-nav-profile img.avatar').src = avatarUrl;
        })
        .catch(function(error) {
          console.error("Ошибка обновления аватарки в нижней панели:", error);
        });
    }
    
    function loadAdmins() {
      var adminsRef = firebase.database().ref('users');
      adminsRef.orderByChild('role').startAt('admin').endAt('admin\uf8ff').once('value')
        .then(function(snapshot) {
          var sidebar = document.querySelector('.admin-sidebar');
          sidebar.querySelectorAll('.admin-account').forEach(el => el.remove());
          snapshot.forEach(function(childSnapshot) {
            var adminData = childSnapshot.val();
            var adminDiv = document.createElement('div');
            adminDiv.classList.add('admin-account');
            adminDiv.addEventListener('click', function() {
              window.location.href = 'admin-seller.html?uid=' + childSnapshot.key;
            });
            
            var adminImg = document.createElement('img');
            adminImg.src = adminData.avatar || 'default-avatar.png';
            adminImg.alt = adminData.nickname || 'Admin';
            adminDiv.appendChild(adminImg);
            
            var adminName = document.createElement('div');
            adminName.classList.add('admin-name');
            adminName.textContent = adminData.nickname || 'Admin';
            adminDiv.appendChild(adminName);
            
            var adminRole = document.createElement('div');
            adminRole.classList.add('admin-role');
            adminRole.textContent = adminData.roleLabel || adminData.role || 'Админ';
            adminDiv.appendChild(adminRole);
            
            sidebar.appendChild(adminDiv);
          });
        })
        .catch(function(error) {
          console.error("Ошибка загрузки админов:", error);
        });
    }
    
    // Поисковые данные и логика
    const items = [
      { name: "Standoff 2", category: "Мобильные игры", link: "standoff2.html", image: "images/csgo.jpg" }
      // можно добавлять другие элементы
    ];
    
    const searchInput = document.querySelector('.search-input');
    const searchButton = document.querySelector('.search-btn');
    const searchResultsContainer = document.getElementById('search-results');
    
    function showSearchResults(query) {
      searchResultsContainer.innerHTML = '';
      if (!query) {
        searchResultsContainer.style.display = 'none';
        return;
      }
      const lowerQuery = query.toLowerCase();
      const filteredItems = items.filter(item =>
        item.name.toLowerCase().includes(lowerQuery) ||
        item.category.toLowerCase().includes(lowerQuery)
      );
      if (filteredItems.length === 0) {
        searchResultsContainer.innerHTML = '<div class="no-results">Ничего не найдено</div>';
      } else {
        filteredItems.forEach(item => {
          const resultItem = document.createElement('div');
          resultItem.classList.add('search-result-item');
          
          const imgElement = document.createElement('img');
          imgElement.src = item.image;
          imgElement.alt = item.name;
          
          const textElement = document.createElement('div');
          textElement.classList.add('result-text');
          
          const nameElement = document.createElement('div');
          nameElement.classList.add('result-name');
          nameElement.textContent = item.name;
          
          const categoryElement = document.createElement('div');
          categoryElement.textContent = item.category;
          
          textElement.appendChild(nameElement);
          textElement.appendChild(categoryElement);
          resultItem.appendChild(imgElement);
          resultItem.appendChild(textElement);
          
          resultItem.addEventListener('click', () => {
            window.location.href = item.link;
          });
          
          searchResultsContainer.appendChild(resultItem);
        });
      }
      searchResultsContainer.style.display = 'block';
    }
    
    searchButton.addEventListener('click', () => {
      const query = searchInput.value.trim();
      showSearchResults(query);
    });
    searchInput.addEventListener('input', () => {
      const query = searchInput.value.trim();
      showSearchResults(query);
    });
    document.addEventListener('click', (e) => {
      if (!e.target.closest('.search-box') && !e.target.closest('#search-results')) {
        searchResultsContainer.style.display = 'none';
      }
    });
    
    firebase.auth().onAuthStateChanged(function(user) {
      if (user) {
        loadHeaderData(user);
        updateBottomNavAvatar(user);
      } else {
        console.log("Пользователь не авторизован");
      }
    });
    
    // Переключение темы
    const themeToggleBtn = document.getElementById('themeToggle');
    function setTheme(theme) {
      if (theme === 'light') {
        document.body.classList.add('light-mode');
        themeToggleBtn.querySelector('span').textContent = '';
      } else {
        document.body.classList.remove('light-mode');
        themeToggleBtn.querySelector('span').textContent = '';
      }
      localStorage.setItem('theme', theme);
    }
    const currentTheme = localStorage.getItem('theme') || 'dark';
    setTheme(currentTheme);
    themeToggleBtn.addEventListener('click', () => {
      const newTheme = document.body.classList.contains('light-mode') ? 'dark' : 'light';
      setTheme(newTheme);
    });
    
    // Обработчик для кнопки гамбургера (если понадобится для админ-панели)
    const hamburgerBtn = document.getElementById('hamburgerBtn');
    if (hamburgerBtn) {
      const adminSidebar = document.getElementById('adminSidebar');
      hamburgerBtn.addEventListener('click', () => {
        adminSidebar.classList.toggle('open');
      });
    }
  </script>
</body>
</html>
