<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>GlovimPlaye | Главная</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
  
  <!-- Font Awesome для иконок -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" />
  
  <!-- Firebase v8 -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
  
  <style>
    /* Общие стили */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Montserrat', sans-serif;
      background: #0e0e0e;
      color: #ccc;
      min-height: 100vh;
      line-height: 1.6;
      padding-bottom: 70px; /* чтобы нижняя панель не перекрывала контент */
      /* Отступ справа для sidebar на десктопе */
      padding-right: 270px;
    }
    a {
      text-decoration: none;
      color: inherit;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }
    
    /* Шапка */
    header {
      background: #161616;
      border-bottom: 1px solid #333;
      padding: 15px 20px;
      position: relative;
      z-index: 2;
    }
    .header-inner {
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
    }
    .logo {
      font-size: 28px;
      font-weight: 600;
      color: #4fc3f7;
      cursor: pointer;
      transition: transform 0.3s;
    }
    .logo:hover {
      transform: scale(1.05);
    }
    
    /* Поиск */
    .search-bar {
      flex: 1;
      max-width: 400px;
      margin: 10px 20px;
      position: relative;
    }
    .search-bar input {
      width: 100%;
      padding: 10px 15px;
      border: none;
      border-radius: 50px;
      background: #1e1e1e;
      color: #ccc;
      outline: none;
      font-size: 15px;
    }
    .search-bar input::placeholder {
      color: #555;
    }
    .search-btn {
      position: absolute;
      right: 5px;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: #4fc3f7;
      font-size: 18px;
      cursor: pointer;
      outline: none;
    }
    
    /* Правый блок меню (чат, баланс, аватар) */
    .header-right {
      display: flex;
      gap: 15px;
      align-items: center;
      flex-wrap: wrap;
    }
    .nav-btn {
      background: none;
      border: none;
      color: #4fc3f7;
      font-size: 20px;
      cursor: pointer;
      transition: color 0.3s;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .nav-btn:hover {
      color: #80deea;
    }
    .nav-btn span {
      font-size: 12px;
      margin-top: 3px;
    }
    .balance {
      display: flex;
      flex-direction: column;
      align-items: center;
      color: #4fc3f7;
      font-size: 14px;
    }
    .balance i {
      font-size: 18px;
      margin-bottom: 2px;
    }
    .profile-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: 2px solid #4fc3f7;
      object-fit: cover;
      cursor: pointer;
      transition: transform 0.3s;
    }
    .profile-avatar:hover {
      transform: scale(1.05);
    }
    
    /* Результаты поиска */
    .search-results {
      position: absolute;
      top: 60px;
      left: 50%;
      transform: translateX(-50%);
      background: #1e1e1e;
      width: 100%;
      max-width: 400px;
      max-height: 300px;
      overflow-y: auto;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.8);
      display: none;
      z-index: 10;
    }
    .search-result-item {
      display: flex;
      align-items: center;
      padding: 10px 15px;
      border-bottom: 1px solid #333;
      cursor: pointer;
      transition: background 0.3s;
    }
    .search-result-item:hover {
      background: #262626;
    }
    .search-result-item img {
      width: 40px;
      height: 40px;
      object-fit: cover;
      border-radius: 4px;
      margin-right: 15px;
    }
    .result-text {
      display: flex;
      flex-direction: column;
    }
    .result-name {
      font-weight: 600;
      color: #fff;
    }
    .no-results {
      padding: 10px 15px;
      color: #888;
    }
    
    /* Заголовок секции */
    .section-title {
      font-size: 20px;
      margin: 30px 0 10px;
      color: #4fc3f7;
    }
    
    /* Горизонтальная прокрутка */
    .horizontal-scroll {
      display: flex;
      overflow-x: auto;
      padding-bottom: 10px;
      scroll-behavior: smooth;
      margin-bottom: 20px;
    }
    .horizontal-scroll::-webkit-scrollbar {
      height: 6px;
    }
    .horizontal-scroll::-webkit-scrollbar-thumb {
      background: #333;
      border-radius: 4px;
    }
    .horizontal-scroll::-webkit-scrollbar-track {
      background: #1e1e1e;
    }
    
    /* Карточки */
    .game-card {
      width: 80px;
      margin-right: 16px;
      text-align: center;
      flex-shrink: 0;
      cursor: pointer;
    }
    .game-card img {
      width: 80px;
      height: 80px;
      object-fit: cover;
      border-radius: 8px;
      transition: transform 0.2s;
    }
    .game-card img:hover {
      transform: scale(1.05);
    }
    .game-card .game-name {
      margin-top: 6px;
      font-size: 13px;
      color: #ccc;
      white-space: nowrap;
    }
    .new-badge {
      display: inline-block;
      background: #ff4500;
      color: #fff;
      font-size: 10px;
      padding: 2px 5px;
      border-radius: 4px;
      margin-left: 5px;
      vertical-align: middle;
    }
    
    /* Нижняя панель (мобильная навигация) */
    .bottom-nav {
      display: none;
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 60px;
      background: #161616;
      border-top: 1px solid #333;
      align-items: center;
      justify-content: space-around;
      z-index: 100;
    }
    .bottom-nav a {
      color: #ccc;
      font-size: 12px;
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .bottom-nav a i {
      font-size: 22px;
      margin-bottom: 3px;
    }
    .bottom-nav a:hover {
      color: #4fc3f7;
    }
    .bottom-nav-profile img.avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      border: 2px solid #4fc3f7;
      object-fit: cover;
      margin-bottom: 2px;
    }
    
    /* Правая боковая панель (админ-секция) */
    .admin-sidebar {
      position: fixed;
      top: 0;
      right: 0;
      width: 250px;
      height: 100%;
      background: #1e1e1e;
      border-left: 1px solid #333;
      padding: 20px;
      overflow-y: auto;
    }
    .admin-sidebar .sidebar-logo {
      font-size: 24px;
      font-weight: 600;
      color: #4fc3f7;
      text-align: center;
      margin-bottom: 20px;
      cursor: pointer;
    }
    .admin-sidebar h3 {
      font-size: 18px;
      color: #fff;
      margin-bottom: 10px;
    }
    .admin-account {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
      background: #262626;
      padding: 10px;
      border-radius: 8px;
      transition: background 0.3s;
      cursor: pointer;
    }
    .admin-account:hover {
      background: #333;
    }
    .admin-account img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin-right: 10px;
      object-fit: cover;
    }
    .admin-account .admin-name {
      font-size: 14px;
      color: #ccc;
    }
    
    /* Футер */
    footer {
      background: #161616;
      color: #777;
      padding: 30px 20px;
      margin-top: 20px;
    }
    footer .container {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-around;
      gap: 20px;
    }
    footer h3, footer h4 {
      color: #4fc3f7;
      margin-bottom: 8px;
    }
    footer a {
      color: #777;
      font-size: 14px;
    }
    footer a:hover {
      color: #fff;
    }
    footer p {
      font-size: 13px;
    }
    .footer-btn {
      background: #4fc3f7;
      color: #121212;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .footer-btn:hover {
      background: #80deea;
    }
    footer p.copyright {
      text-align: center;
      margin-top: 20px;
      font-size: 13px;
    }
    
    /* Адаптивные стили для мобильных устройств */
    @media (max-width: 768px) {
      body {
        /* Убираем отступ справа */
        padding-right: 20px;
      }
      .header-inner {
        flex-direction: column;
        align-items: center;
        gap: 10px;
      }
      .search-bar {
        width: 100%;
        margin: 10px 0;
      }
      .header-right {
        justify-content: center;
      }
      /* Скрываем правую панель с админами */
      .admin-sidebar {
        display: none;
      }
      /* Показываем нижнюю навигацию */
      .bottom-nav {
        display: flex;
      }
    }
  </style>
</head>
<body>
  <!-- Шапка -->
  <header>
    <div class="container">
      <div class="header-inner">
        <!-- Логотип -->
        <div class="logo" onclick="location.href='index.html'">GlovimPlaye</div>
        <!-- Поиск -->
        <div class="search-bar">
          <input type="text" class="search-input" placeholder="Поиск игр и приложений...">
          <button class="search-btn"><i class="fas fa-search"></i></button>
        </div>
        <!-- Меню: чат, баланс и аватар профиля -->
        <div class="header-right">
          <button class="nav-btn" onclick="location.href='chat.html'">
            <i class="fas fa-comment-dots"></i>
            <span>Чат</span>
          </button>
          <div class="balance" id="headerBalance">
            <i class="fas fa-wallet"></i>
            <span>0₽</span>
          </div>
          <img id="headerProfileAvatar" class="profile-avatar" src="default-avatar.png" alt="Avatar" onclick="location.href='profile.html'">
        </div>
      </div>
    </div>
  </header>
  
  <!-- Результаты поиска -->
  <div class="search-results" id="search-results"></div>
  
  <!-- Основной контент -->
  <div class="container">
    <!-- Секция: Игры -->
    <h2 class="section-title">Игры</h2>
    <div class="horizontal-scroll">
      <div class="game-card" onclick="location.href='csgo.html'">
        <img src="images/csgo.jpg" alt="Counter-Strike">
        <div class="game-name">Counter-Strike</div>
      </div>
      <div class="game-card" onclick="location.href='roblox.html'">
        <img src="images/roblox.jpg" alt="Roblox">
        <div class="game-name">Roblox</div>
      </div>
      <div class="game-card" onclick="location.href='minecraft.html'">
        <img src="images/main.jpg" alt="Minecraft">
        <div class="game-name">Minecraft</div>
      </div>
      <div class="game-card" onclick="location.href='fortnite.html'">
        <img src="images/fortna.jpg" alt="Fortnite">
        <div class="game-name">Fortnite</div>
      </div>
      <div class="game-card" onclick="location.href='dota2.html'">
        <img src="images/dota.jpg" alt="Dota 2">
        <div class="game-name">Dota 2</div>
      </div>
      <div class="game-card" onclick="location.href='rust.html'">
        <img src="images/rust.png" alt="Rust">
        <div class="game-name">Rust <span class="new-badge">Новое</span></div>
      </div>
    </div>

    <!-- Секция: Мобильные игры -->
    <h2 class="section-title">Мобильные игры</h2>
    <div class="horizontal-scroll">
      <div class="game-card" onclick="location.href='pubg-mobile.html'">
        <img src="images/pabg mobael.jpg" alt="PUBG Mobile">
        <div class="game-name">PUBG Mobile</div>
      </div>
      <div class="game-card" onclick="location.href='standoff2.html'">
        <img src="images/standoff2.jpg" alt="Standoff 2">
        <div class="game-name">Standoff 2</div>
      </div>
      <div class="game-card" onclick="location.href='callofduty.html'">
        <img src="images/cal of duty.jpg" alt="Call of Duty">
        <div class="game-name">Call of Duty</div>
      </div>
    </div>

    <!-- Секция: Приложения -->
    <h2 class="section-title">Приложения</h2>
    <div class="horizontal-scroll">
      <div class="game-card" onclick="location.href='discord.html'">
        <img src="images/diccord.jpg" alt="Discord">
        <div class="game-name">Discord</div>
      </div>
      <div class="game-card" onclick="location.href='spotify.html'">
        <img src="images/spotifay.jpg" alt="Spotify">
        <div class="game-name">Spotify</div>
      </div>
      <div class="game-card" onclick="location.href='telegram.html'">
        <img src="images/telegram.jpg" alt="Telegram">
        <div class="game-name">Telegram</div>
      </div>
      <div class="game-card" onclick="location.href='steam.html'">
        <img src="images/steam.jpg" alt="Steam">
        <div class="game-name">Steam</div>
      </div>
      <div class="game-card" onclick="location.href='tiktok.html'">
        <img src="images/tiktik.jpg" alt="Tik Tok">
        <div class="game-name">Tik Tok</div>
      </div>
      <div class="game-card" onclick="location.href='epic-gems.html'">
        <img src="images/epgems.jpg" alt="Epic Gems">
        <div class="game-name">Epic Gems</div>
      </div>
      <div class="game-card" onclick="location.href='playstation.html'">
        <img src="images/Playstetion.png" alt="PlayStation">
        <div class="game-name">PlayStation</div>
      </div>
    </div>
  </div>
  
  <!-- Правая боковая панель (админ-секция) для десктопа -->
  <aside class="admin-sidebar">
    <div class="sidebar-logo" onclick="location.href='index.html'">GlovimPlaye</div>
    <h3>Администраторы</h3>
    <!-- Здесь динамически будут загружаться админы -->
  </aside>
  
  <!-- Нижняя панель (мобильная навигация) -->
  <div class="bottom-nav">
    <a href="index.html">
      <i class="fas fa-home"></i>
      <span>Главная</span>
    </a>
    <a href="add.html">
      <i class="fas fa-plus"></i>
      <span>Продать</span>
    </a>
    <a href="chat.html">
      <i class="fas fa-comment-dots"></i>
      <span>Чат</span>
    </a>
    <a href="profile.html" class="bottom-nav-profile">
      <img src="default-avatar.png" alt="Avatar" class="avatar">
      <span>Профиль</span>
    </a>
  </div>
  
  <!-- Футер -->
  <footer>
    <div class="container" style="align-items: center;">
      <div style="max-width: 250px;">
        <h3>GlovimPlaye</h3>
        <p>Безопасная торговая площадка с низкими ценами</p>
        <p>support@glovimplaye.com</p>
      </div>
      <div>
        <h4>Способы оплаты</h4>
        <p>💳 💸 🪙 🎮</p>
      </div>
      <div>
        <h4>Информация</h4>
        <p><a href="#">О компании</a></p>
        <p><a href="#">Правила и гарантии</a></p>
        <p><a href="#">Курсы валют</a></p>
        <p><a href="#">Советы и гайды</a></p>
      </div>
      <div>
        <h4>Наши соц.сети</h4>
        <p><a href="https://t.me/" target="_blank">Telegram канал</a></p>
        <p><a href="https://vk.com/" target="_blank">Группа ВКонтакте</a></p>
        <p><a href="https://www.youtube.com/" target="_blank">YouTube канал</a></p>
        <p><a href="https://discord.com/" target="_blank">Discord сервер</a></p>
      </div>
      <div>
        <button class="footer-btn">Написать в техподдержку</button>
      </div>
    </div>
    <p class="copyright">
      © 2025 GlovimPlaye. Все права защищены.
    </p>
  </footer>
  
  <script>
    // Firebase-конфигурация
    var firebaseConfig = {
      apiKey: "AIzaSyAhn2H2BExFFf7GO2k_YDfrwPiV_cYdUBg",
      authDomain: "glovimplaye-b1023.firebaseapp.com",
      databaseURL: "https://glovimplaye-b1023-default-rtdb.firebaseio.com",
      projectId: "glovimplaye-b1023",
      storageBucket: "glovimplaye-b1023.firebasestorage.app",
      messagingSenderId: "553440591519",
      appId: "1:553440591519:web:b7be45a9253689f322acaa"
    };

    // Инициализация Firebase, если ещё не инициализировано
    if (!firebase.apps.length) {
      firebase.initializeApp(firebaseConfig);
    }

    // Устанавливаем постоянство сессии
    firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL)
      .then(function() {
        console.log("Сессия установлена");
        loadAdmins();
      })
      .catch(function(error) {
        console.error("Ошибка установки сессии:", error);
      });
      
    // Обновление данных пользователя в хедере (баланс, аватар)
    function loadHeaderData(user) {
      var userId = user.uid;
      firebase.database().ref('users/' + userId).once('value')
        .then(function(snapshot) {
          var userData = snapshot.val();
          if (userData) {
            document.querySelector('#headerBalance span').innerText =
              (userData.balance !== undefined ? userData.balance : 0) + '₽';
            var avatarUrl = userData.avatar || user.photoURL || 'default-avatar.png';
            document.getElementById('headerProfileAvatar').src = avatarUrl;
          } else {
            console.log("Данные пользователя не найдены");
          }
        })
        .catch(function(error) {
          console.error("Ошибка чтения данных пользователя:", error);
        });
    }
    
    // Загрузка администраторов
    function loadAdmins() {
      var adminsRef = firebase.database().ref('users');
      adminsRef.orderByChild('role').equalTo('admin').once('value')
        .then(function(snapshot) {
          var sidebar = document.querySelector('.admin-sidebar');
          sidebar.querySelectorAll('.admin-account').forEach(el => el.remove());
          snapshot.forEach(function(childSnapshot) {
            var adminData = childSnapshot.val();
            var adminDiv = document.createElement('div');
            adminDiv.classList.add('admin-account');
            adminDiv.addEventListener('click', function() {
              window.location.href = 'admin-profile.html?uid=' + childSnapshot.key;
            });
            
            var adminImg = document.createElement('img');
            adminImg.src = adminData.avatar || 'default-avatar.png';
            adminImg.alt = adminData.nickname || 'Admin';
            adminDiv.appendChild(adminImg);
            
            var adminName = document.createElement('div');
            adminName.classList.add('admin-name');
            adminName.textContent = adminData.nickname || 'Admin';
            adminDiv.appendChild(adminName);
            
            sidebar.appendChild(adminDiv);
          });
        })
        .catch(function(error) {
          console.error("Ошибка загрузки админов:", error);
        });
    }
    
    // Логика поиска
    const items = [
      { name: "Standoff 2", category: "Мобильные игры", link: "standoff2.html", image: "images/standoff2.jpg" },
      { name: "Mobile Legends", category: "Мобильные игры", link: "mobile-legends.html", image: "images/mobile_legends.jpg" },
      { name: "PUBG Mobile", category: "Мобильные игры", link: "pubg-mobile.html", image: "images/pubg_mobile.jpg" },
      { name: "Brawl Stars", category: "Мобильные игры", link: "brawl-stars.html", image: "images/brawl_stars.jpg" },
      { name: "Counter-Strike", category: "PC-игры", link: "csgo.html", image: "images/csgo.jpg" },
      { name: "Dota 2", category: "PC-игры", link: "dota2.html", image: "images/dota.jpg" },
      { name: "Call of Duty", category: "PC-игры", link: "callofduty.html", image: "images/cal of duty.jpg" },
      { name: "Fortnite", category: "PC-игры", link: "fortnite.html", image: "images/fortna.jpg" },
      { name: "GTA 5 Online", category: "PC-игры", link: "gta5.html", image: "images/gta.jpg" },
      { name: "Minecraft", category: "PC-игры", link: "minecraft.html", image: "images/main.jpg" },
      { name: "Rust", category: "PC-игры", link: "rust.html", image: "images/rust.png" },
      { name: "Roblox", category: "Мобильные игры", link: "roblox.html", image: "images/roblox.jpg" },
      { name: "PUBG", category: "PC-игры", link: "pubg.html", image: "images/pabg.png" },
      { name: "Discord", category: "Приложения", link: "discord.html", image: "images/diccord.jpg" },
      { name: "Epic Gems", category: "Приложения", link: "epic-gems.html", image: "images/epgems.jpg" },
      { name: "PlayStation", category: "Приложения", link: "playstation.html", image: "images/Playstetion.png" },
      { name: "Spotify", category: "Приложения", link: "spotify.html", image: "images/spotifay.jpg" },
      { name: "Steam", category: "Приложения", link: "steam.html", image: "images/steam.jpg" },
      { name: "Telegram", category: "Приложения", link: "telegram.html", image: "images/telegram.jpg" },
      { name: "Tik Tok", category: "Приложения", link: "tiktok.html", image: "images/tiktik.jpg" }
    ];
    
    const searchInput = document.querySelector('.search-input');
    const searchButton = document.querySelector('.search-btn');
    const searchResultsContainer = document.getElementById('search-results');
    
    function showSearchResults(query) {
      searchResultsContainer.innerHTML = '';
      if (!query) {
        searchResultsContainer.style.display = 'none';
        return;
      }
      const lowerQuery = query.toLowerCase();
      const filteredItems = items.filter(item =>
        item.name.toLowerCase().includes(lowerQuery) ||
        item.category.toLowerCase().includes(lowerQuery)
      );
      if (filteredItems.length === 0) {
        searchResultsContainer.innerHTML = '<div class="no-results">Ничего не найдено</div>';
      } else {
        filteredItems.forEach(item => {
          const resultItem = document.createElement('div');
          resultItem.classList.add('search-result-item');
          
          const imgElement = document.createElement('img');
          imgElement.src = item.image;
          imgElement.alt = item.name;
          
          const textElement = document.createElement('div');
          textElement.classList.add('result-text');
          
          const nameElement = document.createElement('div');
          nameElement.classList.add('result-name');
          nameElement.textContent = item.name;
          
          const categoryElement = document.createElement('div');
          categoryElement.textContent = item.category;
          
          textElement.appendChild(nameElement);
          textElement.appendChild(categoryElement);
          resultItem.appendChild(imgElement);
          resultItem.appendChild(textElement);
          
          resultItem.addEventListener('click', () => {
            window.location.href = item.link;
          });
          
          searchResultsContainer.appendChild(resultItem);
        });
      }
      searchResultsContainer.style.display = 'block';
    }
    
    searchButton.addEventListener('click', () => {
      const query = searchInput.value.trim();
      showSearchResults(query);
    });
    searchInput.addEventListener('input', () => {
      const query = searchInput.value.trim();
      showSearchResults(query);
    });
    document.addEventListener('click', (e) => {
      if (!e.target.closest('.search-bar') && !e.target.closest('#search-results')) {
        searchResultsContainer.style.display = 'none';
      }
    });
    
    // Обработка авторизации: обновление хедера после входа
    firebase.auth().onAuthStateChanged(function(user) {
      if (user) {
        loadHeaderData(user);
      } else {
        console.log("Пользователь не авторизован");
      }
    });
  </script>
</body>
</html>
